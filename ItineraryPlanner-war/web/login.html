<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Travellab. Login</title>
        <!-- Tell the browser to be responsive to screen width -->
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
        <!-- Ionicons -->
        <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
        <!-- Theme style -->
        <link rel="stylesheet" href="./dist/css/adminlte.min.css">
        <!-- iCheck -->
        <link rel="stylesheet" href="./plugins/iCheck/square/blue.css">
        <!-- Google Font: Source Sans Pro -->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <style>
            html,
            body,
            header,
            #intro {
                height: 100%;
            }
            body{
                background: url("https://images.unsplash.com/photo-1558879177-69cde6b279c7?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80")no-repeat center center fixed;
                -webkit-background-size: cover;
                -moz-background-size: cover;
                -o-background-size: cover;
                background-size: cover;
            }
            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
            }
        </style>
    </head>

    <body >
        <div class="login-box">
            <div class="login-logo">
                <a href="index1.html"><b>TRAVELLAB</b></a>
            </div>
            <!-- /.login-logo -->
            <div class="card">
                <div class="card-body login-card-body">
                    <h3 class="login-box-msg">LOGIN</h3>

                    <form id="form">
                        <div class="form-group has-feedback">
                            <h6 style="text-align: center"><b>Username</b></h6>
                            <input type="text" id="userName" class="form-control" placeholder="Username" />
                        </div>
                        <div class="form-group has-feedback">
                            <h6 style="text-align: center"><b>Password</b></h6>
                            <input type="password" id="password" class="form-control" placeholder="Password" />
                        </div>
                        <div class="row">
                            <div class="col-4 mx-auto">
                                <input type="submit" id="login" class="btn btn-primary btn-block btn-flat " value="Login"/>
                            </div>
                            <!-- /.col -->
                        </div>
                    </form>

                    <p class="mb-0" style="text-align: center">
                        <a href="register.html">Have not signed up?</a>
                    </p>
                </div>
                <!-- /.login-card-body -->
            </div>
        </div>
        <!-- /.login-box -->

        <!-- jQuery -->
        <script src="./plugins/jquery/jquery.min.js"></script>
        <!-- Bootstrap 4 -->
        <script src="./plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
        <!-- iCheck -->
        <script src="./plugins/iCheck/icheck.min.js"></script>
        <script>
            $(function () {
                $('input').iCheck({
                    checkboxClass: 'icheckbox_square-blue',
                    radioClass: 'iradio_square-blue',
                    increaseArea: '20%' // optional
                })
            })
        </script>
        <script>
            $(document).ready(function () {
                $('#form').submit(function () {
                    var userName = $("#userName").val()
                    var password = $("#password").val()
                    var body = JSON.stringify({
                        "userName": userName,
                        "password": password
                    })
                    $.ajax({
                        type: "POST",
                        url: 'http://localhost:8080/ItineraryPlanner-war/webresources/users/login',
                        data: body,
                        contentType: "application/json; charset=utf-8",
                        success: function (data, textStatus, xhr)
                        {
                            sessionStorage.setItem('uId', data.uId);
                            sessionStorage.setItem('userName', userName);
                            sessionStorage.setItem('token', data.accessToken);
                            alert("You have successful logged in")
                            window.location.href = "home1.html";
                            console.log(data)
                            console.log("User ID: ", sessionStorage.getItem('uId'))
                            console.log("Username: ", sessionStorage.getItem('userName'))
                            console.log("Token: ", sessionStorage.getItem('token'))
                            console.log(textStatus)
                        },
                        error: function (xhr, error, errorType) {
                            alert("Error logging in...")
                        }
                    });
                    return false;
                });
            });
        </script>
    </body>
</html>